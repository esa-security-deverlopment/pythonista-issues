pythonista3://?exec=%23%20coding:%20utf-8%0A%0A%27%27%27%0AAn%20experimental%20hybrid%20of%20an%20analog%20and%20digital%20stopwatch%20--%20tap%20anywhere%20to%20start/stop/reset.%0A%27%27%27%0A%0Afrom%20scene%20import%20*%0Aimport%20sound%0Afrom%20functools%20import%20partial%0Afrom%20time%20import%20time%0Aimport%20ui%0A%0Aif%20min%28ui.get_screen_size%28%29%29%20%3C%20750:%0A%09digit_h%20%3D%2060%0Aelse:%0A%09digit_h%20%3D%20100%0Adigit_w%20%3D%20digit_h%20*%200.9%0A%0Ainvert_shader_src%20%3D%20%27%27%27%0A%23extension%20GL_EXT_shader_framebuffer_fetch%20:%20require%0Avoid%20main%28%29%20%7Bgl_FragColor%20%3D%20vec4%281.0%20-%20gl_LastFragData%5B0%5D.rgb,%201.0%29;%7D%0A%27%27%27%0A%0Aclass%20ReelNode%20%28Node%29:%0A%09def%20__init__%28self,%20count%3D10%29:%0A%09%09Node.__init__%28self%29%0A%09%09self.count%20%3D%20count%0A%09%09self.labels%20%3D%20%5B%5D%0A%09%09self.container%20%3D%20Node%28parent%3Dself%29%0A%09%09font%20%3D%20%28%27Avenir%20Next%27,%20digit_h%29%0A%09%09for%20i%20in%20range%28count%20*%203%29:%0A%09%09%09label%20%3D%20LabelNode%28str%28i%25count%29,%20font%3Dfont%29%0A%09%09%09label.position%20%3D%200,%20-i%20*%20digit_h%0A%09%09%09self.container.add_child%28label%29%0A%09%09%09self.labels.append%28label%29%0A%09%09self.set_value%280%29%0A%09%0A%09def%20set_value%28self,%20value%29:%0A%09%09value%20%3D%20min%28self.count,%20max%280,%20value%29%29%0A%09%09self.value%20%3D%20value%0A%09%09y%20%3D%20self.count%20*%20digit_h%20%2B%20digit_h%20*%20value%0A%09%09self.container.position%20%3D%20%280,%20y%29%0A%09%09for%20label%20in%20self.labels:%0A%09%09%09label_y%20%3D%20y%20%2B%20label.position.y%0A%09%09%09label.alpha%20%3D%201.0%20-%20abs%28label_y%29%20/%20%28digit_h*5.0%29%0A%09%09%09label.scale%20%3D%20label.alpha%0A%09%0A%09def%20animate_to%28self,%20value,%20d%3D0.2%29:%0A%09%09from_value%20%3D%20self.value%0A%09%09to_value%20%3D%20value%0A%09%09def%20anim%28from_value,%20to_value,%20node,%20p%29:%0A%09%09%09node.set_value%28from_value%20%2B%20p%20*%20%28to_value-from_value%29%29%0A%09%09animation%20%3D%20Action.call%28partial%28anim,%20from_value,%20to_value%29,%20d%29%0A%09%09self.run_action%28animation%29%0A%09%09%0Aclass%20StopWatch%20%28Scene%29:%0A%09def%20setup%28self%29:%0A%09%09self.started%20%3D%20False%0A%09%09self.start_time%20%3D%200%0A%09%09self.stopped%20%3D%20False%0A%09%09self.root%20%3D%20Node%28parent%3Dself%29%0A%09%09self.reels%20%3D%20%5B%5D%0A%09%09for%20i%20in%20range%285%29:%0A%09%09%09reel%20%3D%20ReelNode%28count%3D6%20if%20i%20in%20%280,%202%29%20else%2010%29%0A%09%09%09x%20%3D%20%28i-2%29%20*%20digit_w%0A%09%09%09x%20%2B%3D%2010%20*%20%281%20if%20i%252%20%3D%3D%200%20else%20-1%29%0A%09%09%09reel.position%20%3D%20x,%200%0A%09%09%09self.root.add_child%28reel%29%0A%09%09%09self.reels.append%28reel%29%0A%09%09colon%20%3D%20LabelNode%28%27:%27,%20font%3D%28%27Avenir%20Next%27,%20digit_h%29,%20position%3D%28-digit_w/2,%200%29,%20parent%3Dself.root%29%0A%09%09dot%20%3D%20LabelNode%28%27.%27,%20font%3D%28%27Avenir%20Next%27,%20digit_h%29,%20position%3D%28digit_w*1.5,%200%29,%20parent%3Dself.root%29%0A%09%09overlay%20%3D%20SpriteNode%28size%3D%28max%28self.size%29,%20digit_h%20%2B%2010%29%29%0A%09%09overlay.shader%20%3D%20Shader%28invert_shader_src%29%0A%09%09self.root.add_child%28overlay%29%0A%09%09self.background_color%20%3D%20%27black%27%0A%09%09self.did_change_size%28%29%0A%09%0A%09def%20did_change_size%28self%29:%0A%09%09self.root.position%20%3D%20self.size/2%0A%09%09%0A%09def%20update%28self%29:%0A%09%09if%20not%20self.started:%0A%09%09%09return%0A%09%09elapsed%20%3D%20time%28%29%20-%20self.start_time%0A%09%09minutes%20%3D%20elapsed%20//%2060%0A%09%09seconds%20%3D%20elapsed%20%25%2060.0%0A%09%09v4%20%3D%20elapsed%20%25%201.0%20*%2010.0%0A%09%09v3%20%3D%20seconds%20%25%2010%0A%09%09v2%20%3D%20%28seconds%20//%2010%29%20%2B%20v3%20/%2010.0%0A%09%09v1%20%3D%20minutes%20%25%2010%20%2B%20seconds%20/%2060.0%0A%09%09v0%20%3D%20minutes%20//%2010%20%2B%20v1%20/%2010.0%0A%09%09self.reels%5B0%5D.set_value%28v0%29%0A%09%09self.reels%5B1%5D.set_value%28v1%29%0A%09%09self.reels%5B2%5D.set_value%28v2%29%0A%09%09self.reels%5B3%5D.set_value%28v3%29%0A%09%09self.reels%5B4%5D.set_value%28v4%29%0A%09%09%0A%09def%20touch_began%28self,%20touch%29:%0A%09%09if%20not%20self.started:%0A%09%09%09if%20not%20self.stopped:%0A%09%09%09%09%23%20Start%0A%09%09%09%09sound.play_effect%28%27ui:switch19%27%29%0A%09%09%09%09self.start_time%20%3D%20time%28%29%0A%09%09%09%09self.started%20%3D%20True%0A%09%09%09else:%0A%09%09%09%09%23%20Reset%0A%09%09%09%09sound.play_effect%28%27ui:switch20%27%29%0A%09%09%09%09for%20reel%20in%20self.reels:%0A%09%09%09%09%09reel.animate_to%280,%200.3%29%0A%09%09%09%09self.stopped%20%3D%20False%0A%09%09else:%0A%09%09%09%23%20Stop%0A%09%09%09sound.play_effect%28%27ui:switch2%27%29%0A%09%09%09self.stopped%20%3D%20True%0A%09%09%09self.started%20%3D%20False%0A%09%09%09for%20reel%20in%20self.reels:%0A%09%09%09%09reel.animate_to%28int%28reel.value%29%29%0A%09%09%09%0Aif%20__name__%20%3D%3D%20%27__main__%27:%0A%09run%28StopWatch%28%29%29%0A